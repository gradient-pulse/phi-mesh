<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Phi-Mesh Tag Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- D3 v7 -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    :root{
      --bg:#0e0f12; --fg:#e6edf6; --muted:#9aa5b1; --panel:#0f1116;
      --border:#1f2330; --chip:#141a24; --link:#7dc1ff;
      --linkStroke: rgba(200,215,235,0.32);
      --linkStrokeDim: rgba(200,215,235,0.10);
      --nodeFill:#52a2ff;
    }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);
      font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    a{color:var(--link);text-decoration:none} a:hover{text-decoration:underline}

    /* Layout: one left sidebar + main graph */
    #app{display:grid;grid-template-columns:320px 1fr;grid-template-rows:auto 1fr;height:100%}
    header{grid-column:1/3;display:flex;gap:16px;align-items:center;
      padding:10px 12px;border-bottom:1px solid var(--border);background:#0f1116}
    header h1{font-size:16px;font-weight:600;margin:0}
    #status{margin-left:auto;color:var(--muted);font-size:12px}

    #left{border-right:1px solid var(--border);padding:12px;overflow:auto;background:linear-gradient(180deg,#0f1116,#0f1116ea,#0f1116e0)}
    #main{position:relative;overflow:hidden}
    #search{width:100%;padding:8px;border-radius:8px;border:1px solid var(--border);
      background:var(--panel);color:var(--fg);outline:none}
    .muted{color:var(--muted);font-size:12px}
    #details{margin-top:10px}

    /* Tooltip */
    #tooltip{position:absolute;pointer-events:none;z-index:20;background:#11151f;
      color:#e6edf6;border:1px solid #2a2f3d;border-radius:8px;padding:8px 10px;
      font-size:13px;max-width:340px;box-shadow:0 6px 24px rgba(0,0,0,.4);display:none}

    /* Graph visuals */
    svg{width:100%;height:100%;display:block}
    .link{stroke:var(--linkStroke);stroke-width:1.2}
    .link.dim{stroke:var(--linkStrokeDim)}
    .node{cursor:pointer}
    .node circle{fill:var(--nodeFill);opacity:.95}
    .node text{fill:#cfd6e4;font-size:11px;pointer-events:none}
    .node.dim circle{opacity:.25}
    .node.dim text{opacity:.25}

    /* Satellites (pulses) */
    .satellites{pointer-events:none}
    .satellites .satellite{pointer-events:all;cursor:pointer}
    .satellites .satellite circle{stroke:#10131a;stroke-width:1.5px}

    .age-very-new{fill:#ff6b6b}
    .age-new{fill:#ff9e66}
    .age-mid{fill:#ffc94d}
    .age-old{fill:#8ecbff}
    .age-very-old{fill:#6aa4ff;opacity:.9}

    .pill{display:inline-block;padding:4px 8px;border-radius:999px;background:#141a24;
      border:1px solid #243047;color:#cfe1ff;font-size:12px;margin:2px 6px 0 0}
  </style>
</head>
<body>
  <div id="app">
    <header>
      <h1>Phi-Mesh Tag Map</h1>
      <div class="muted">Hover a tag for its description • Click a tag to show pulse satellites • Click a pulse to see details</div>
      <div id="status" class="muted"></div>
    </header>

    <aside id="left">
      <div class="muted">Search tags</div>
      <input id="search" placeholder="Type to filter…" />
      <div style="margin-top:10px" class="muted">
        Newer pulses appear warmer (red/orange); older ones cooler (blue).
      </div>
      <div id="details"></div>
    </aside>

    <main id="main">
      <div id="tooltip"></div>
      <svg id="graph"></svg>
    </main>
  </div>

  <!-- Data then behavior -->
  <script src="data.js"></script>
  <script src="graph.js?v=one-sidebar"></script>
</body>
</html>
