<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Phi-Mesh Tag Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --bg:#0b0c10; --panel:#0f1219; --fg:#e9eef8; --muted:#9aacbf;
      --node:#86c1ff; --nodeDim:#86c1ff33; --link:#b9c7dd; --linkDim:#b9c7dd22;
      --accent:#ff9b7a; --chip:#ff7a66;
    }
    html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    .app{display:grid;grid-template-columns:330px 1fr 360px;grid-template-rows:100vh;gap:0}
    aside{background:linear-gradient(180deg,var(--panel),rgba(18,18,28,.94));display:flex;flex-direction:column;min-width:0}
    aside.right{border-left:1px solid rgba(255,255,255,.06)}
    header{padding:14px 14px 8px 14px;border-bottom:1px solid rgba(255,255,255,.06)}
    h1{margin:0 0 6px;font-size:18px;letter-spacing:.2px}
    .hint{color:var(--muted);font-size:12px}
    #search{width:100%;background:#0f1117;border:1px solid rgba(255,255,255,.08);color:var(--fg);padding:9px 10px;border-radius:10px;outline:none}

    .panel-body{padding:14px;overflow:auto}
    /* left details */
    #details h2{margin:.2rem 0 .4rem 0;font-size:18px}
    #details .date{color:var(--muted);font-weight:600}
    #details .summary{white-space:pre-wrap;margin:.6rem 0 1rem 0;font-size:13px}
    #details .block>strong{display:block;margin:.5rem 0 .25rem 0}
    #details .block a{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:12.5px}

    /* right list */
    #pulses h2{margin:0 0 6px 0;font-size:16px}
    #pulse-list{list-style:none;margin:8px 0 0; padding:0}
    #pulse-list li{display:flex;align-items:center;gap:8px;padding:6px 8px;border-radius:8px;cursor:pointer}
    #pulse-list li:hover{background:rgba(255,255,255,.06)}
    .dot{width:8px;height:8px;border-radius:50%}
    .dot.recent{background:#ff7a66}
    .dot.mid{background:#ffb066}
    .dot.old{background:#86cbff}
    .title{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:13px}

    /* Graph */
    svg{width:100%;height:100vh;background:transparent}
    .link{stroke:var(--link);stroke-opacity:.35}
    .link.dim{stroke:var(--linkDim)}
    .node text{font-size:12px;fill:#d7e6fa;paint-order:stroke;stroke:#0007;stroke-width:.8px;pointer-events:none}
    .node ellipse{fill:var(--node);stroke:none}
    .node.dim ellipse{fill:var(--nodeDim)}
    .node.dim text{opacity:.25;filter:grayscale(60%)}
    .node.selected ellipse{fill:#ff8f77}

    #tooltip{
      position:fixed;left:0;top:0;display:none;background:#0f1522;color:var(--fg);
      border:1px solid rgba(255,255,255,.08);border-radius:10px;padding:10px 12px;max-width:300px;
      box-shadow:0 6px 18px rgba(0,0,0,.35);pointer-events:none;z-index:20;font-size:12.5px
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <script src="data.js"></script>
  <script defer src="map.js"></script>
</head>
<body>
  <div class="app">
    <aside class="left">
      <header>
        <h1>Phi-Mesh Tag Map</h1>
        <div class="hint">Hover a tag for its description • Click a tag to list pulses • Click a pulse to see details</div>
        <input id="search" type="search" placeholder="Type to filter…" />
      </header>
      <div id="details" class="panel-body"><!-- starts empty --></div>
    </aside>

    <svg id="graph" role="img" aria-label="Tag Map"></svg>

    <aside class="right">
      <header>
        <h1>Pulses</h1>
        <div class="hint" id="pulse-hint">Click a tag to list its pulses.</div>
      </header>
      <div id="pulses" class="panel-body">
        <h2 id="pulses-title"></h2>
        <ul id="pulse-list"></ul>
      </div>
    </aside>
  </div>
  <div id="tooltip"></div>
</body>
</html>
