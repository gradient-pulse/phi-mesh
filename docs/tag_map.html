<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>RGP Tag Map</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    html, body { margin:0; padding:0; height:100%; overflow:hidden; font-family:sans-serif; }
    #container { display:flex; height:100vh; width:100vw; }
    #sidebar { width:280px; background:#f4f4f4; padding:10px; overflow-y:auto; }
    #sidebar h1 { font-size:20px; margin-bottom:4px; }
    #sidebar p { font-size:13px; margin-bottom:14px; }
    #graph { flex-grow:1; overflow:hidden; }
    #link-list { list-style:none; padding-left:0; }
    #link-list li { margin-bottom:6px; font-size:13px; }
    #link-list li strong { display:block; font-weight:bold; margin-top:8px; }
    #link-list a { color:steelblue; text-decoration:none; font-size:13px; }
    #link-list a:hover { text-decoration:underline; }
  </style>
</head>
<body>
  <div id="container">
    <div id="sidebar">
      <h1>RGP Tag Map</h1>
      <p>Coherence Tracking Across Fieldsâ€”click a tag</p>
      <ul id="link-list"></ul>
    </div>
    <div id="graph"></div>
  </div>

  <!-- Base data + graph (must load first) -->
  <script src="data.js"></script>
  <script src="graph_data.js"></script>
  <script>
    // Optional overlay: if workflow wrote a versioned file path into window.GRAPH_SRC,
    // load it AFTER the base graph_data.js to overwrite window.graph.
    (function () {
      try {
        if (window && window.GRAPH_SRC && window.GRAPH_SRC !== 'graph_data.js') {
          var s = document.createElement('script');
          s.src = window.GRAPH_SRC;
          s.onload = function(){ console.log('[tag_map] overlay graph loaded:', s.src); };
          s.onerror = function(){ console.warn('[tag_map] failed to load overlay graph:', s.src); };
          document.head.appendChild(s);
        }
      } catch (e) {
        console.warn('[tag_map] overlay load skipped:', e);
      }
    })();
  </script>

  <!-- Sidebar + layout -->
  <script src="link_index.js"></script>
  <script src="sidebar_display.js"></script>
  <script src="graph_layout.js"></script>
</body>
</html>
